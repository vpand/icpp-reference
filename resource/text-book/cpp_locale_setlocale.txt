std::setlocale

   From cppreference.com
   < cpp | locale

   C++
   Compiler support
   Freestanding and hosted
   Language
   Standard library
   Standard library headers
   Named requirements
   Feature test macros (C++20)
   Language support library
   Concepts library (C++20)
   Metaprogramming library (C++11)
   Diagnostics library
   General utilities library
   Strings library
   Containers library
   Iterators library
   Ranges library (C++20)
   Algorithms library
   Numerics library
   Localizations library
   Input/output library
   Filesystem library (C++17)
   Regular expressions library (C++11)
   Concurrency support library (C++11)
   Technical specifications
   Symbols index
   External libraries

   Localization library
   Locales and facets
   Locales
   has_facet
   use_facet
   locale
   Facet category base classes
   ctype_base
   codecvt_base
   messages_base

   time_base
   money_base
   ctype facets
   ctype
   ctype<char>
   ctype_byname
   codecvt
   codecvt_byname
   numeric facets
   num_get
   num_put
   numpunct
   numpunct_byname
   collate facets
   collate
   collate_byname
   time facets
   time_get
   time_put
   time_get_byname
   time_put_byname
   monetary facets
   money_get
   money_put
   moneypunct
   moneypunct_byname

   messages facets
   messages
   messages_byname
   Character classification and conversion
   Character classification
   isspace
   isblank
   (C++11)
   iscntrl
   isupper
   islower
   isalpha
   ispunct
   isdigit
   isxdigit
   isalnum
   isprint
   isgraph
   Character conversions
   toupper

   tolower
   String and stream conversions
   wstring_convert
   (C++11/17/26*)
   wbuffer_convert
   (C++11/17/26*)
   Text encoding identifications
   text_encoding
   (C++26)
   Unicode conversion facets
   codecvt_utf8
   (C++11/17/26*)
   codecvt_utf16
   (C++11/17/26*)
   codecvt_utf8_utf16
   (C++11/17/26*)
   codecvt_mode
   (C++11/17/26*)
   C library locales
   LC_ALLLC_COLLATELC_CTYPELC_MONETARYLC_NUMERICLC_TIME

   setlocale
   localeconv
   lconv

   Defined in header <clocale>
   char* setlocale( int category, const char* locale );

   The setlocale function installs the specified system locale or its
   portion as the new C locale. The modifications remain in effect and
   influences the execution of all locale-sensitive C library functions
   until the next call to setlocale. If locale is a null pointer,
   setlocale queries the current C locale without modifying it.

Parameters

   category - locale category identifier, one of the LC_xxx macros. May be
   0.
   locale - system-specific locale identifier. Can be "" for the
   user-preferred locale or "C" for the minimal locale

Return value

   Pointer to a narrow null-terminated string identifying the C locale
   after applying the changes, if any, or null pointer on failure.

   A copy of the returned string along with the category used in this call
   to std::setlocale may be used later in the program to restore the
   locale back to the state at the end of this call.

Notes

   During program startup, the equivalent of std::setlocale(LC_ALL, "C");
   is executed before any user code is run.

   Although the return type is char*, modifying the pointed-to characters
   is undefined behavior.

   Because setlocale modifies global state which affects execution of
   locale-dependent functions, it is undefined behavior to call it from
   one thread, while another thread is executing any of the following
   functions: std::fprintf, std::isprint, std::iswdigit, std::localeconv,
   std::tolower, std::fscanf, std::ispunct, std::iswgraph, std::mblen,
   std::toupper, std::isalnum, std::isspace, std::iswlower, std::mbstowcs,
   std::towlower, std::isalpha, std::isupper, std::iswprint, std::mbtowc,
   std::towupper, std::isblank, std::iswalnum, std::iswpunct,
   std::setlocale, std::wcscoll, std::iscntrl, std::iswalpha,
   std::iswspace, std::strcoll, std::wcstod, std::isdigit, std::iswblank,
   std::iswupper, std::strerror, std::wcstombs, std::isgraph,
   std::iswcntrl, std::iswxdigit, std::strtod, std::wcsxfrm, std::islower,
   std::iswctype, std::isxdigit.

   POSIX also defines a locale named "POSIX", which is always accessible
   and is exactly equivalent to the default minimal "C" locale.

   POSIX also specifies that the returned pointer, not just the contents
   of the pointed-to string, may be invalidated by subsequent calls to
   setlocale.

Example

   Run this code
#include <clocale>
#include <cstdio>
#include <ctime>
#include <cwchar>
#include <iterator>
#include <string>

int main()
{
    // Make a "deep copy" of current locale name.
    std::string prev_loc = std::setlocale(LC_ALL, nullptr);

    // The C locale will be UTF-8 enabled English,
    // decimal dot will be German,
    // date and time formatting will be Japanese.
    if (const char* loc = std::setlocale(LC_ALL, "en_US.UTF-8"))
        std::wprintf(L"New LC_ALL locale: %s\n", loc);
    if (const char* loc = std::setlocale(LC_NUMERIC, "de_DE.UTF-8"))
        std::wprintf(L"New LC_NUMERIC locale: %s\n", loc);
    if (const char* loc = std::setlocale(LC_TIME, "ja_JP.UTF-8"))
        std::wprintf(L"New LC_TIME locale: %s\n", loc);

    wchar_t buf[100];
    std::time_t t = std::time(nullptr);
    std::wcsftime(buf, std::size(buf), L"%A %c", std::localtime(&t));
    std::wprintf(L"Number: %.2f\nDate: %Ls\n", 3.14, buf);

    // Restore the previous locale.
    if (const char* loc = std::setlocale(LC_ALL, prev_loc.c_str()))
        std::wprintf(L"Restorred LC_ALL locale: %s\n", loc);
}

   Possible output:
New LC_ALL locale: en_US.UTF-8
New LC_NUMERIC locale: de_DE.UTF-8
New LC_TIME locale: ja_JP.UTF-8
Number: 3,14
Date: ее 2022┤1106е 204059
Restorred LC_ALL locale: C

See also

   LC_ALLLC_COLLATELC_CTYPELC_MONETARYLC_NUMERICLC_TIME
   locale categories for std::setlocale
   (macro constant)
   locale
   set of polymorphic facets that encapsulate cultural differences
   (class)

External links

   1.  List of Windows locale names.
   2.  List of Linux locale names.
   Retrieved from
   "https://en.cppreference.com/mwiki/index.php?title=cpp/locale/setlocale
   &oldid=171498"

Navigation

     * Online version
     * Offline version retrieved 2024-06-10 08:17.

     * This page was last modified on 3 May 2024, at 09:19.
     * This page has been accessed 254,140 times.
